<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üá≤üá≤ MyanOS Cloud IDE</title>
    <style>
        /* Myanmar Flag UI Theme - Customized by Gemini */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Padauk', sans-serif; }

        :root {
            --myanmar-yellow: #fecb00; /* ·Ä°·Äù·Ä´·Äõ·Ä±·Ä¨·ÄÑ·Ä∫ (·ÄÖ·Ää·Ä∫·Ä∏·Äú·ÄØ·Ä∂·Ä∏·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏) */
            --myanmar-green: #34b233;  /* ·Ä°·ÄÖ·Ä≠·Äô·Ä∫·Ä∏·Äõ·Ä±·Ä¨·ÄÑ·Ä∫ (·ÄÑ·Äº·Ä≠·Äô·Ä∫·Ä∏·ÄÅ·Äª·Äô·Ä∫·Ä∏·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏) */
            --myanmar-red: #ea2839;    /* ·Ä°·Äî·ÄÆ·Äõ·Ä±·Ä¨·ÄÑ·Ä∫ (·Äõ·Ä≤·Äõ·ÄÑ·Ä∑·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏) */
            --star-white: #ffffff;      /* ·ÄÄ·Äº·Äö·Ä∫·Äñ·Äº·Ä∞·Äõ·Ä±·Ä¨·ÄÑ·Ä∫ (·ÄÖ·ÄÑ·Ä∫·ÄÄ·Äº·Äö·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏) */
            --bg: #0a110a;             /* Dark Greenish Background */
            --surface: #151d15;
            --text: #e0e0e0;
        }

        body {
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header with Flag Gradient */
        .header {
            background: var(--surface);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 4px solid;
            border-image: linear-gradient(to right, var(--myanmar-yellow) 33.33%, var(--myanmar-green) 33.33% 66.66%, var(--myanmar-red) 66.66%) 1;
        }

        .logo {
            color: var(--myanmar-yellow);
            font-size: 1.6rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .db-online { color: var(--myanmar-green); background: rgba(52, 178, 51, 0.1); padding: 5px 15px; border-radius: 20px; border: 1px solid var(--myanmar-green); }
        .db-offline { color: var(--myanmar-red); background: rgba(234, 40, 57, 0.1); padding: 5px 15px; border-radius: 20px; border: 1px solid var(--myanmar-red); }

        .main {
            flex: 1;
            display: flex;
            padding: 20px;
            gap: 20px;
            min-height: 0;
        }

        /* File Manager Panel */
        .file-manager {
            width: 280px;
            background: var(--surface);
            border: 1px solid var(--myanmar-green);
            border-radius: 12px;
            padding: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .file-header {
            display: flex;
            justify-content: space-between;
            color: var(--myanmar-yellow);
            margin-bottom: 15px;
            font-weight: bold;
            border-bottom: 1px solid var(--myanmar-green);
            padding-bottom: 10px;
        }

        .file-list { flex: 1; overflow-y: auto; }

        .file-item {
            padding: 10px 12px;
            border-bottom: 1px solid #2a332a;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            transition: 0.2s;
        }

        .file-item:hover { background: rgba(254, 203, 0, 0.1); color: var(--myanmar-yellow); }

        /* Buttons & Inputs */
        .btn {
            background: transparent;
            border: 1px solid var(--myanmar-yellow);
            color: var(--myanmar-yellow);
            padding: 6px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn:hover { background: var(--myanmar-yellow); color: #000; }

        .btn-primary {
            background: var(--myanmar-red);
            color: var(--star-white);
            border: 1px solid var(--myanmar-red);
            font-weight: bold;
        }

        .btn-primary:hover { background: #ff3d4d; }

        /* Editor Panel */
        .editor-panel {
            flex: 1;
            background: var(--surface);
            border: 1px solid var(--myanmar-yellow);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }

        .toolbar {
            padding: 15px;
            border-bottom: 1px solid var(--myanmar-yellow);
            display: flex;
            gap: 12px;
            background: rgba(254, 203, 0, 0.05);
        }

        #filename {
            background: #000;
            border: 1px solid var(--myanmar-green);
            color: var(--myanmar-yellow);
            padding: 5px 10px;
            border-radius: 4px;
            flex: 1;
            outline: none;
        }

        textarea {
            flex: 1;
            background: #050805;
            border: none;
            color: #fff;
            font-family: 'Consolas', monospace;
            padding: 20px;
            font-size: 15px;
            outline: none;
            resize: none;
            line-height: 1.5;
        }

        .output {
            background: #000;
            border-top: 2px solid var(--myanmar-green);
            padding: 15px;
            min-height: 120px;
            max-height: 180px;
            overflow-y: auto;
            font-family: monospace;
            white-space: pre-wrap;
            color: var(--myanmar-green);
        }

        /* Right Side Panel */
        .right-panel {
            width: 280px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .info-box {
            background: var(--surface);
            border: 1px solid var(--myanmar-red);
            border-radius: 12px;
            padding: 15px;
        }

        .info-box h3 {
            color: var(--myanmar-red);
            margin-bottom: 12px;
            font-size: 1rem;
            border-bottom: 1px solid rgba(234, 40, 57, 0.3);
            padding-bottom: 5px;
        }

        .history-item {
            padding: 8px;
            border-bottom: 1px solid #2a2a2a;
            font-size: 0.8rem;
        }

        .footer {
            background: var(--surface);
            padding: 12px;
            text-align: center;
            border-top: 2px solid var(--myanmar-red);
            font-size: 0.9rem;
            color: var(--myanmar-yellow);
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo"><span>üá≤üá≤</span> MyanOS Cloud IDE</div>
        <div>
            <span id="dbStatus" class="db-offline">üî¥ Database Offline</span>
        </div>
    </div>

    <div class="main">
        <div class="file-manager">
            <div class="file-header">
                <span>üìÅ Database Files</span>
                <button class="btn" onclick="refreshFiles()" id="refreshBtn">üîÑ</button>
            </div>
            <div id="fileList" class="file-list">
                <div style="color: #666; text-align: center;">Loading...</div>
            </div>
            <div style="margin-top: 10px; font-size:0.75rem; color:#888; text-align:center;">Double-click file to load</div>
        </div>

        <div class="editor-panel">
            <div class="toolbar">
                <button class="btn btn-primary" onclick="runCode()">‚ñ∂Ô∏è Run</button>
                <button class="btn" onclick="saveToDB()">üíæ Save</button>
                <button class="btn" onclick="newFile()">üìÑ New</button>
                <input type="text" id="filename" value="program.my" placeholder="filename.my">
            </div>
            <textarea id="editor" spellcheck="false">·Äï·ÄØ·Ä∂·Äî·Äæ·Ä≠·Äï·Ä∫ "·Äô·ÄÑ·Ä∫·Äπ·ÄÇ·Äú·Ä¨·Äï·Ä´ MyanOS"

·ÄÄ·Ä≠·Äî·Ä∫·Ä∏ x = ·ÅÅ·ÅÄ
·ÄÄ·Ä≠·Äî·Ä∫·Ä∏ y = ·ÅÇ·ÅÄ
·Äï·ÄØ·Ä∂·Äî·Äæ·Ä≠·Äï·Ä∫ "x + y = " + (x + y)

·Ä°·ÄÄ·Äö·Ä∫·Åç (x > ·ÅÖ) {
    ·Äï·ÄØ·Ä∂·Äî·Äæ·Ä≠·Äï·Ä∫ "x ·ÄÄ ·ÅÖ ·Äë·ÄÄ·Ä∫·ÄÄ·Äº·ÄÆ·Ä∏·Äê·Äö·Ä∫"
}</textarea>
            <div class="output" id="output">Ready for execution...</div>
        </div>

        <div class="right-panel">
            <div class="info-box">
                <h3>üìú Run History</h3>
                <div id="historyList"></div>
            </div>
            <div class="info-box">
                <h3>‚ÑπÔ∏è Database Info</h3>
                <p style="font-size:0.85rem; margin-bottom:5px;">Server: localhost:8000</p>
                <p style="font-size:0.85rem; margin-bottom:5px;">DB: myanmos_db</p>
                <p style="font-size:0.85rem;">Status: <span id="dbStatusText" style="color:var(--myanmar-red);">Checking...</span></p>
            </div>
        </div>
    </div>

    <div class="footer">
        MyanOS Cloud v2.0.0 | Built by Aung Moe Oo | Powered by Gemini
    </div>

    <script>
        // ==================== MYANMAR CODE ENGINE ====================
        class MyanmarCodeEngine {
            constructor() {
                this.digits = {'·ÅÄ':'0','·ÅÅ':'1','·ÅÇ':'2','·ÅÉ':'3','·ÅÑ':'4','·ÅÖ':'5','·ÅÜ':'6','·Åá':'7','·Åà':'8','·Åâ':'9'};
            }

            execute(code) {
                try {
                    let output = [];
                    let jsCode = code;

                    for (let mm in this.digits) {
                        jsCode = jsCode.replace(new RegExp(mm, 'g'), this.digits[mm]);
                    }

                    jsCode = jsCode.replace(/·Äï·ÄØ·Ä∂·Äî·Äæ·Ä≠·Äï·Ä∫\s+(.+)/g, 'console.log($1)');
                    jsCode = jsCode.replace(/·ÄÄ·Ä≠·Äî·Ä∫·Ä∏\s+([a-zA-Z_]+)\s*=\s*([^;\n]+)/g, 'let $1 = $2');
                    jsCode = jsCode.replace(/·Ä°·ÄÄ·Äö·Ä∫·Åç\s*\((.+?)\)/g, 'if ($1)');
                    jsCode = jsCode.replace(/·Äô·Äü·ÄØ·Äê·Ä∫·Äï·Ä´·ÄÄ/g, '} else {');

                    const sandbox = {
                        console: { log: (...args) => output.push(args.join(' ')) }
                    };

                    const func = new Function('sandbox', 'with(sandbox) { ' + jsCode + ' }');
                    func(sandbox);

                    return { success: true, output: output.join('\n') };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }
        }

        const engine = new MyanmarCodeEngine();
        const DB_URL = 'http://localhost:8000';

        async function checkDB() {
            try {
                let response = await fetch(DB_URL);
                let data = await response.json();
                if (data.status === 'MyanOS Database Online') {
                    document.getElementById('dbStatus').innerHTML = 'üü¢ Database Online';
                    document.getElementById('dbStatus').className = 'db-online';
                    document.getElementById('dbStatusText').innerHTML = 'Connected';
                    document.getElementById('dbStatusText').style.color = 'var(--myanmar-green)';
                    return true;
                }
            } catch (error) {
                document.getElementById('dbStatus').innerHTML = 'üî¥ Database Offline';
                document.getElementById('dbStatus').className = 'db-offline';
                document.getElementById('dbStatusText').innerHTML = 'Disconnected';
                document.getElementById('dbStatusText').style.color = 'var(--myanmar-red)';
                return false;
            }
        }

        async function saveToDB() {
            let filename = document.getElementById('filename').value;
            let content = document.getElementById('editor').value;
            try {
                let response = await fetch(`${DB_URL}/files/save?filename=${encodeURIComponent(filename)}&content=${encodeURIComponent(content)}`, { method: 'POST' });
                let data = await response.json();
                if (data.status === 'ok') {
                    showOutput(`‚úÖ File [${filename}] saved to database`);
                    refreshFiles();
                }
            } catch (error) { showOutput(`‚ùå Save failed: Database unreachable`); }
        }

        async function refreshFiles() {
            let fileList = document.getElementById('fileList');
            fileList.innerHTML = 'Refreshing...';
            try {
                let response = await fetch(`${DB_URL}/files`);
                let data = await response.json();
                if (data.files && data.files.length > 0) {
                    fileList.innerHTML = '';
                    data.files.forEach(file => {
                        let div = document.createElement('div');
                        div.className = 'file-item';
                        div.ondblclick = () => { document.getElementById('filename').value = file.name; };
                        div.innerHTML = `<span>üìÑ ${file.name}</span> <span style="color:#666; font-size:0.7rem;">${file.created}</span>`;
                        fileList.appendChild(div);
                    });
                } else { fileList.innerHTML = '<div style="text-align:center; color:#555;">No files found</div>'; }
            } catch (error) { fileList.innerHTML = `<div style="color:var(--myanmar-red); font-size:0.8rem;">DB Error</div>`; }
        }

        function runCode() {
            let code = document.getElementById('editor').value;
            let result = engine.execute(code);
            if (result.success) {
                showOutput(result.output || "Code executed (No output)");
                addToHistory(code, result.output);
            } else {
                showOutput('‚ùå Error: ' + result.error);
                addToHistory(code, 'ERROR');
            }
        }

        function showOutput(text) { document.getElementById('output').innerText = text; }

        function newFile() {
            document.getElementById('editor').value = '·Äï·ÄØ·Ä∂·Äî·Äæ·Ä≠·Äï·Ä∫ "·Äô·ÄÑ·Ä∫·Äπ·ÄÇ·Äú·Ä¨·Äï·Ä´"';
            document.getElementById('filename').value = 'new_file.my';
            showOutput('Created new file buffer');
        }

        function addToHistory(code, output) {
            let historyList = document.getElementById('historyList');
            let div = document.createElement('div');
            div.className = 'history-item';
            let time = new Date().toLocaleTimeString();
            div.innerHTML = `<div style="color:var(--myanmar-yellow)">${code.substring(0,20)}...</div><div style="color:#666; font-size:0.7rem;">${time}</div>`;
            historyList.insertBefore(div, historyList.firstChild);
        }

        window.onload = async function() {
            await checkDB();
            await refreshFiles();
            setInterval(checkDB, 15000);
        };
    </script>
</body>
</html>
